- [Linux系统安装](#linux%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85)
- [Linux常用命令](#linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4)
  - [一、命令基本格式](#%E4%B8%80%E5%91%BD%E4%BB%A4%E5%9F%BA%E6%9C%AC%E6%A0%BC%E5%BC%8F)
    - [命令提示符](#%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AC%A6)
    - [命令格式](#%E5%91%BD%E4%BB%A4%E6%A0%BC%E5%BC%8F)
    - [查询目录中内容：`ls`命令](#%E6%9F%A5%E8%AF%A2%E7%9B%AE%E5%BD%95%E4%B8%AD%E5%86%85%E5%AE%B9ls%E5%91%BD%E4%BB%A4)
    - [Linux中的文件权限](#linux%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90)
  - [二、文件处理命令](#%E4%BA%8C%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E5%91%BD%E4%BB%A4)
  - [2.1 目录和文件处理命令](#21-%E7%9B%AE%E5%BD%95%E5%92%8C%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86%E5%91%BD%E4%BB%A4)
    - [建立目录](#%E5%BB%BA%E7%AB%8B%E7%9B%AE%E5%BD%95)
    - [切换目录（change directory）](#%E5%88%87%E6%8D%A2%E7%9B%AE%E5%BD%95change-directory)
    - [显示当前工作目录（print working directory）](#%E6%98%BE%E7%A4%BA%E5%BD%93%E5%89%8D%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95print-working-directory)
    - [删除空目录（remove empty directories）](#%E5%88%A0%E9%99%A4%E7%A9%BA%E7%9B%AE%E5%BD%95remove-empty-directories)
    - [删除文件或目录（remove）](#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E6%88%96%E7%9B%AE%E5%BD%95remove)
    - [复制文件或目录](#%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6%E6%88%96%E7%9B%AE%E5%BD%95)
    - [剪切文件或目录（重命名命令）](#%E5%89%AA%E5%88%87%E6%96%87%E4%BB%B6%E6%88%96%E7%9B%AE%E5%BD%95%E9%87%8D%E5%91%BD%E5%90%8D%E5%91%BD%E4%BB%A4)
    - [常见目录的作用](#%E5%B8%B8%E8%A7%81%E7%9B%AE%E5%BD%95%E7%9A%84%E4%BD%9C%E7%94%A8)
  - [2.2 链接（文件）命令](#22-%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6%E5%91%BD%E4%BB%A4)
    - [链接命令](#%E9%93%BE%E6%8E%A5%E5%91%BD%E4%BB%A4)
    - [硬链接和软链接区别](#%E7%A1%AC%E9%93%BE%E6%8E%A5%E5%92%8C%E8%BD%AF%E9%93%BE%E6%8E%A5%E5%8C%BA%E5%88%AB)
  - [三、文件搜索命令](#%E4%B8%89%E6%96%87%E4%BB%B6%E6%90%9C%E7%B4%A2%E5%91%BD%E4%BB%A4)
    - [文件搜索命令`locate`](#%E6%96%87%E4%BB%B6%E6%90%9C%E7%B4%A2%E5%91%BD%E4%BB%A4locate)
    - [文件搜索命令`find`](#%E6%96%87%E4%BB%B6%E6%90%9C%E7%B4%A2%E5%91%BD%E4%BB%A4find)
    - [字符串搜索命令`grep`](#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%90%9C%E7%B4%A2%E5%91%BD%E4%BB%A4grep)
    - [`find`命令与`grep`命令的区别](#find%E5%91%BD%E4%BB%A4%E4%B8%8Egrep%E5%91%BD%E4%BB%A4%E7%9A%84%E5%8C%BA%E5%88%AB)
    - [搜索命令的命令`whereis`与`which`](#%E6%90%9C%E7%B4%A2%E5%91%BD%E4%BB%A4%E7%9A%84%E5%91%BD%E4%BB%A4whereis%E4%B8%8Ewhich)
    - [`$PATH`环境变量](#path%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F)
  - [四、帮助命令](#%E5%9B%9B%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4)
    - [`man`](#man)
    - [其他帮助命令](#%E5%85%B6%E4%BB%96%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4)
  - [五、压缩与解压缩命令](#%E4%BA%94%E5%8E%8B%E7%BC%A9%E4%B8%8E%E8%A7%A3%E5%8E%8B%E7%BC%A9%E5%91%BD%E4%BB%A4)
    - [常用压缩格式](#%E5%B8%B8%E7%94%A8%E5%8E%8B%E7%BC%A9%E6%A0%BC%E5%BC%8F)
    - [zip(.zip)](#zipzip)
    - [gzip(.gz)](#gzipgz)
    - [.bz2](#bz2)
    - [打包命令tar（.tar）](#%E6%89%93%E5%8C%85%E5%91%BD%E4%BB%A4tartar)
  - [六、关机和重启命令](#%E5%85%AD%E5%85%B3%E6%9C%BA%E5%92%8C%E9%87%8D%E5%90%AF%E5%91%BD%E4%BB%A4)
    - [`shutdown`命令](#shutdown%E5%91%BD%E4%BB%A4)
    - [其他关机命令](#%E5%85%B6%E4%BB%96%E5%85%B3%E6%9C%BA%E5%91%BD%E4%BB%A4)
    - [其他重启命令](#%E5%85%B6%E4%BB%96%E9%87%8D%E5%90%AF%E5%91%BD%E4%BB%A4)
    - [系统运行级别](#%E7%B3%BB%E7%BB%9F%E8%BF%90%E8%A1%8C%E7%BA%A7%E5%88%AB)
  - [七、其他常用命令](#%E4%B8%83%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4)
    - [挂载命令](#%E6%8C%82%E8%BD%BD%E5%91%BD%E4%BB%A4)
      - [1.查询与自动挂载](#1%E6%9F%A5%E8%AF%A2%E4%B8%8E%E8%87%AA%E5%8A%A8%E6%8C%82%E8%BD%BD)
      - [2.挂载命令格式](#2%E6%8C%82%E8%BD%BD%E5%91%BD%E4%BB%A4%E6%A0%BC%E5%BC%8F)
      - [3.挂载光盘](#3%E6%8C%82%E8%BD%BD%E5%85%89%E7%9B%98)
      - [4.卸载命令](#4%E5%8D%B8%E8%BD%BD%E5%91%BD%E4%BB%A4)
      - [5.挂载U盘](#5%E6%8C%82%E8%BD%BDu%E7%9B%98)
    - [用户登录查看命令](#%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%9F%A5%E7%9C%8B%E5%91%BD%E4%BB%A4)
      - [1.`w`](#1w)
      - [2.`who`](#2who)

# Linux系统安装

1.各个组件或设备在Linux下都是一个文件。

2.各硬件设备在Linux下的文件名

| 设备                 | 文件名           |
| ------------------ | ------------- |
| IDE硬盘              | /dev/hdp[a-d] |
| SCSI/SATA/USB硬盘/U盘 | /dev/sd[a-p]  |

。。。

硬盘分区之后，各个分区的文件名是原文件名加数字，如：/dev/sda1,/dev/sda2……。1，2，3，4四个号码只能给主分区或扩展分区使用，逻辑分区从5开始。

**3.磁盘的组成**

磁盘可以细分出扇区和柱面两种单位。每个扇区为512byte。

磁盘的第一个扇区主要记录了两个重要信息：

- 主引导分区（Master Boot Record，MBR）：可以安装引导加载程序的地方，有446Byte。
- 分区表（partion table）：记录整块硬盘分区的状态，有64bytes。

**4.磁盘分区表**

在分区表所在的64bytes容量中，总共分为四组记录区，每组记录区记录了该区段的起始于结束的柱面号码。（从1开始，不包括0。0是第一个扇区。）

- 所谓“磁盘分区”就是对64byte的分区表进行设置。
- 硬盘默认的分区表仅能写入四组分区信息。这四组分区信息称为主分区（或者扩展分区，扩展分区最多有一个）。
- 分区的最小单位为柱面（即一个柱面所包含的字节数）。
- 逻辑分区是由扩展分区持续切割出来的分区。
- 能够被格式化后作为数据访问的分区为主分区和逻辑分区。扩展分区无法格式化。

**5.开机流程与主引导分区（MBR）**

BIOS---->MBR，引导加载程序---->加载内核文件

- BIOS：基本输入输出系统。由主板提供。
- 引导加载程序（Boot loader）：操作系统安装时安装到MBR中的程序。其提供的功能有：
  - 提供菜单，让用户可以选择不同的开机选项。（多系统）
  - 载入内核文件：直接指向可开机的程序区段来开始操作系统。
  - 转交其他loader：将引导加载功能转交给其他loader负责。

计算机可能具有两个以上的引导加载程序。引导加载程序除了可以安装在MBR外，还可以安装在每个分区的引导扇区内。

- 每个分区都拥有自己的启动扇区
- 实际可开机的内核文件时放置在各个分区内的。
- loader只会认识自己的系统分区内的可开机内核文件，以及其他loader而已（？）。

**6.为什么装多系统时，最好先装windows？**

因为Windows安装时会直接覆盖MBR。而Linux安装时，可以选择将boot loader安装到MBR还是个别分区的启动扇区。

**7.目录树与文件系统**

Linux中所有的数据都是以文件的形态来呈现，形成一个目录树结构。根目录的表示方法为一条斜线“/”，其他所有文件都是由根目录衍生而来，如：/home/dmtsai/mydata。

**8.格式化**

格式化（高级格式化）又称逻辑格式化，它是指根据用户选定的文件系统（Windows：FAT16，FAT32，NTFS等，Linux：EXT2，EXT3，EXT4等），在磁盘的特定区域写入特定数据，在分区中划出一片用于存放文件分配表、目录表等用于文件管理的磁盘空间。

**9.挂载**

所谓“**挂载**”就是利用一个目录当成进入点，将某**磁盘分区**的数据放置在该目录下；也就是说，进入该目录就可以读取该分区。

几乎所有的目录（除了个别目录），都可以作为挂载点。

- 必须分区
  - / ：根分区
  - swap分区：交换分区（虚拟内存），内存较小时，推荐为内存2倍。内存较大时，比内存大2GB。没有挂载点。
- 推荐分区
  - /boot：启动分区，200MB。其他目录占满了，也不影响系统启动。

**10.Linux管理员名是root**

安装好之后，localhost login输入root，以管理员身份登录：

```bash
localhost login:root
Password:
```

**10.安装完Linux后，会生产安装日志文件。**

* /root/install.log：存储了安装在系统中的软件包及其版本信息
* /root/install.log.syslog：存储了安装过程中留下的事件记录
* /root/anaconda-ks.log：以Kickstart配置文件的格式记录安装过程中设置的选项信息。利用该文件，可以批量安装其他机器。

> PS：在centos 7中，安装完成后，没有前两个日志文件。

**11.XShell**

XShell是一个Linux远程管理工具。相当于window的MSTSC，只是不能看到画面。

按照视频中的方法，在虚拟机中，通过ifconfig命令看不到ip地址。参照这篇文字解决了问题：http://blog.csdn.net/geerniya/article/details/79088588



# Linux常用命令

## 一、命令基本格式

### 命令提示符

```bash
[root@localhost ~]#
```

* root：代表当前登录用户。root是Linux当中的管理员。

* @：没有特殊含义。

* localhost：代表当前主机名。Linux默认主机名是localhost。可以修改。

* ~：当前所在目录名。~代表的是家目录。用户登录之后，有一个初始登录目录。这个目录就是家目录。
  * 对于管理员root来讲，他的家目录是/root目录（根目录下的root目录，一级目录）。
  * 对于普通用户来讲，家目录是/home/user1/（二级目录）。当创建用户时，会自动创建对应的家目录。

* \#：命令行提示符。

  * \#：超级用户提示符
  * $：普通用户提示符


### 命令格式

```bash
命令 [选项] [参数]
```

* []代表可选。
* 个别命令不遵循该格式。
* 选项通常用来调整命令功能的。
  * 当有多个选项时，可以将他们写在一起。比如，`-l`，`-a`两个选项，可写在一起为`-al`。
  * 选项分为简化选项和完整选项。如`--all`的简化选项时`-a`。
* 参数通常用于指定命令操作的对象。

### 查询目录中内容：`ls`命令

```bash
ls [选项] [文件或目录]
```

* 选项：
  * -a：显示所有文件，包括隐藏文件。在Linux中，文件名以`.`开头的文件是隐藏文件。
  * -l：显示详细信息。
  * -d：查看目录属性。若不使用-d，则以某个目录为参数时，显示的是该目录下所有文件，而非该目录本身信息。
  * -h：人性化显示文件大小。
  * -i：显示inode。Linux是通过inode编号来寻找文件的。每个文件都有一个inode编号。


使用`ls -l`打印出来的详细信息实例：

```bash
-rw-------. 1 root root 1502 1月  19 07:04 anaconda-ks.cfg
```

* `-rw-------.`：文件权限。
* `1`：引用计数。
  * 如果文件是**普通文件**，则代表文件的硬链接数目。没有硬链接则为1。每有一个硬链接，就增加1。
  * 如果文件是**目录文件**，则代表该目录下有多少个子目录。新建一个空白的目录，其引用计数为2，不是0。因为，空白目录下实际上有两个隐藏的目录，`.`和`..`，分别指向当前目录和父目录。
* 第一个`root`：文件的所有者。
* 第二个`root`：文件的所属组。
* `1502`：文件大小。单位是字节Byte。通过加上`-h`参数，即`ls -lh`，即以合适的单位显示文件大小。
* `1月  19 07:04`：文件的最后一次修改时间。
* `anaconda-ks.cfg`：文件名。




PS: 可以用`ll`命令代替`ls -l`命令。



### Linux中的文件权限

权限默认是十位。

例：

```bash
-rw-r--r--
```

* 第一位代表文件类型。Linux中一共有七种文件类型（Linux不是靠扩展名来区分文件类型。Linux没有扩展名的概念）
  * `-`代表普通文件。
    * 纯文本文件（ascii）。
    * 二进制文件（binary）。
    * 数据格式文件（data）。
  * `d`：代表目录。
  * `l`：代表软链接文件。Symbol Link。
  * `c`：字符设备文件。如鼠标，键盘。
  * `b`：块设备文件。如硬盘。
  * `s`：套接口文件。
  * `p`：管道文件。
* 剩下九位，以每三位为一组，分别指定不同用户的`r`读、`w`写、`x`执行权限。
  * 2-4位。u所有者权限。
  * 5-7位。g所属组权限。
  * 8-10位。o其他人权限。


centOS 6之后，权限后面还多了一位，`.`。这个点应该是代表ACL权限。



PS：命令行清屏：`ctrl+L`



## 二、文件处理命令

## 2.1 目录和文件处理命令

### 建立目录

* `mkdir [-p] [目录名]`
  * -p：递归创建。当试图创建嵌套的多层目录时，如`mkdir japan/cangls`，若每层目录都不存在，则会创建失败。此时，需要加上`-p`，递归创建，才能成功。

### 切换目录（change directory）

* `cd [目录名]`
* 简化操作：
  * `cd ~`或者`cd`：直接进入当前用户的家目录。
  * `cd -`：进入上次所在目录。可以再次输入，但只能返回一个层级，即输入后又返回原始目录，形成循环，A->B，B->A。
  * `cd ..`：进入上层目录。即父目录。注意cd后有空格。
  * `cd .`：进入当前目录。并没有效果，不会切换目录。但`.`代表当前目录，需要记住，在指定相对目录时有用。

补充说明：

* 相对路径：参照当前所在目录，进行查找。以`.`当前目录或者`...`父目录开头。
  * 如：`[root@immoc ~]# cd ../usr/local/src/`
* 绝对路径：从根目录开始制定，一级一级递归查找。以`/`开头。在任何目录下，都能依据指定的绝对路径进入指定位置。
  * 如：`[root!immoc ~]# cd /etc/`



PS：

* Linux下，切换目录时，可以通过tab显示所有子目录。双击两下tab，即可显示当前目录下（与已输入目录名匹配的）的所有子目录。如`cd /`双击两下tab，会显示根目录下所有子目录。
* 双击两下tab还有自动显示可用命令的功能。

### 显示当前工作目录（print working directory）

* pwd

### 删除空目录（remove empty directories）

* `rmdir [目录名]`
  * 特别注意：该命令只能删除空白的目录。若目录下有其他文件，则会删除失败。
  * 该命令并不常使用，通常使用`rm -rf`。

### 删除文件或目录（remove）

* `rm [-rf] [文件或目录]`
  * 基本的使用情景是，用rm删除文件。输入`rm abc`，删除名为abc的普通文件。系统询问“是否删除abc”，我们输入“y”，然后删除成功。当视图删除目录时，会报错。
  * 选项`-r`：删除目录。当加入该选项后，删除目录不会报错。删除目录时，针对目录和目录下的每一个子文件，会递归地询问“是否删除”，需要每一个都选择Y。
  * 选项`-f`：强制删除。加上该选项后，系统不会再询问是否删除。

* 特别注意！：

  * 命令行界面下，删除了就删除了，没有回收站。

  * Linux可以识别`rm -rf /`这个命令，这会删除根目录下所有（现在是99%）文件！！！！！

### 复制文件或目录

* `cp [选项] [原文件或目录] [目标目录/新文件名、目录名]`：
  * `-r`：复制目录。不加该选项，不能复制目录，只能复制文件。
  * `-p`：连带文件属性一起复制。比如文件创建时间，默认复制得到的新文件的创建时间是复制操作执行的时间，而非源文件的创建时间。加上该命令后，则也会复制创建时间。
  * `-d`：若文件是链接文件，则复制链接属性。
  * `-a`：相当于`-pdr`三个选项一起输入。

### 剪切文件或目录（重命名命令）

* `mv [原文件或目录] [目标目录]`
  * 注意，该命令没有选项，可以直接剪切目录，不需要加`-r`，和`cp`命令相区别。
* 当指定源文件和目标文件在同一个目录下时，其实就是重命名：
  * 如，`cp aaaa bbbb`，相当于将aaaa文件重命名为bbbb。

### 常见目录的作用

* `/`根目录
* `/root`：超级用户的家目录。
* `/home`：普通用户的家目录的目录。
* `/bin`：命令保存目录。`/bin`目录用于保存普通用户就能够执行的命令。`/sbin`目录用于保存超级管理员能够执行的命令。
  * `/bin`是`/usr/bin`的软链接。`/sbin`是`/usr/sbin`的软链接。
* `/sbin`：命令保存目录。只有超级用户才能使用其中命令。`/bin`目录用于保存普通用户就能够执行的命令。`/sbin`目录用于保存超级管理员能够执行的命令。
  - `/bin`是`/usr/bin`的软链接。`/sbin`是`/usr/sbin`的软链接。
* `/lib`：系统库保存目录。Linux系统中的一些功能以库的形式保存在此目录中，当需要使用时，调用这些库。
  * `/lib`是`/usr/lib`的软链接。
* `/boot`：启动目录。其中保存系统的启动数据。通常需要专门分一个区来保存其中数据。、
* `/dev`： 设备文件保存目录。
* `/etc`：配置文件保存目录。
* `/mnt`：挂载目录。最常用的挂载目录。通常习惯于在这个目录下新建各种子目录，用于挂载外部设备。
* `/media`：挂载目录。
* `/misc`：挂载目录。
* `/tmp`：临时目录。
* `/proc`：直接写入内存的。是内存的挂载点。用户不应该操作。
* `/sys`：直接写入内存的。是内存的挂载点。用户不应该能操作。
* `/usr`：系统软件资源目录，Unix System Resource。
  * `/usr/bin/`：系统命令（普通用户）。
  * `/usr/sbin`：系统命令（超级用户）。
* `/var`：系统相关文档内容。系统产生的不可自动销毁的缓存文件、日志记录。



## 2.2 链接（文件）命令

### 链接命令

* `ln [-s] [源文件路径] [目标文件路径]`，在[目标文件路径]处创建一个链接文件，它"链接到"[源文件路径]处。对于硬链接和软链接来说，”链接到“的含义并不相同。
  * `-s`：创建软链接。
  * **特别注意**：这个命令的实际含义是，在[目标文件路径]处创建文件，链接到[源文件路径]。如果创建的是硬链接，则[源文件链接]使用绝对路径还是相对路径都无所谓，因为硬链接是直接指向源文件inode节点。而如果创建的是软链接，则[源文件路径]是相对路径还是绝对路径，就非常有区别了。因为软链接是新建了自己的inode节点和block块，block块中保存着指定的[源文件链接]。当通过软链接打开文件时，它将从block块中读取出[源文件链接]，然后相对于自己所在目录去寻找文件。故，若[源文件链接]使用相对目录，且软链接不是创建在当前目录，则可能无法正确链接到源文件。故创建软链接时，尽量使用绝对路径。除非就是想让软链接链接到相对其所在目录的一个文件。



### 硬链接和软链接区别

* 硬链接特征：
		1.拥有相同的i节点（文件索引表项目）和存储block块，可以看做是同一个文件。彼此互为硬链接。
    2.可通过i节点识别。若两个文件i节点相同，则两者互为硬链接。没有其他方法来区分。
    3.创建了硬链接后，用ll命令查看文件，会发现引用计数（硬链接数）增加了1。
    4.不能跨分区。因为每个分区都会格式化，都拥有自己的文件索引表。故硬链接和源文件必然存在于同一个分区内。
    5.不能针对目录使用。
    6.删除硬链接，对关联的其他硬链接无影响。

![硬链接](E:\Reading_Notes\Linux\img\硬链接.jpg)

* 软链接特性：
  1. 类似window的快捷方式。
  2. 软链接拥有自己的I节点和Block块，但是数据块中只保存原文件的文件名和I节点，并没有实际的文件数据。
  3. 用ll查看软链接文件，显示：`lrwxrwxrwx`，开头的l代表软链接。软链接的文件权限都是`rwxrwxrwx`。
  4. 无论通过原文件，还是软链接，打开文件并修改，都会对另一个文件产生影响。
  5. 删除原文件，则软链接不再可用。

![软链接](E:\Reading_Notes\Linux\img\软链接.jpg)






## 三、文件搜索命令

### 文件搜索命令`locate`

* `locate 文件名`：在后台数据库中搜索包含指定文件名的文件（注意，目录也是文件），**搜索速度快**。
* locate并不是直接遍历文件系统进行搜索，而是查找的位于`/var/lib/mlocate/mlocate.db`的数据库文件（不同Linux版本名字可能不同），该数据库默认每天自动更新一次。
  * 优点是速度极快。
  * 缺点是无法查找到新创建的文件，因为新文件还没有添加进数据库。另外，只能通过文件名进行搜索。
* `updatedb`：强制更新mlocate数据库。
* `locate`命令的查询，遵循`/etc/updatedb.conf`配置文件中配置的搜索限制。配置项包括：
  * `PRUNE_BIND_MOUNTS="yes"`。是否开启搜索限制。这是个总开关。当为yes时，以下三个配置项生效。当为no时，以下配置项都不生效。
  * `PRUNEFS="..."`：指定不搜索哪些文件系统。
  * `PRUNENAMES="..."`：指定不搜索以这些后缀结尾的文件。默认有“ .git .hg .svn”。
  * `PRUNEPATHS="..."`：指定不搜索哪些路径。注意，默认配置不会搜索`/tmp`目录下的内容。



### 文件搜索命令`find`

* `find [搜索范围] [搜索条件]`

  * 例子：`find / -name install.log`，搜索根目录下名字为install.log的文件。
  * 避免大范围搜索，会非常消耗系统资源。
  * 默认只会搜索名称完全匹配的文件。若想实现模糊匹配，需要使用通配符。

* Linux中的通配符：

  * `*`：匹配任意内容。例，`find /root -name "install.log*"`。使用通配符最好加引号，避免识别错误。
  * `?`：匹配任意一个字符。
  * `[]`：匹配任意一个中括号内的字符。

* `find`的选项：

  * `-name`：按文件名搜索，区分大小写。
  * `-iname`：按文件名搜索，不区分大小写。
  * `-user`：按搜索者搜索。
  * `-nouser`：搜索没有所有者的文件。 没有所有者的文件，通常为垃圾文件。但是有例外，如内核产生的文件；外来文件。
  * `-mtime`（按天），`-mmin`（按分钟）：按修改文件内容的时间搜索文件。
    * `find /var/log/ -mtime -10`：查找10天内修改过的文件。
    * `find /var/log/ -mtime 10`：查找10天前当天修改过的文件。
    * `find /var/log/ -mtime +10`：查找10天前修改过的文件。
  * `-atime`，`-amin`：按文件访问时间搜索文件。
  * `-ctime`，`-cmin`：按改变文件属性的时间搜索文件。
  * `-size`：按文件大小来搜索文件。
    * `find . -size -25k`：搜索小于25kB的文件。注意小写k。
    * `find . -size 25k`：搜索等于25kB的文件。
    * `find . -size +25k`：搜索大于25kB的文件。
    * 也可按照`M`来查找，大写M。
    * 注意，默认单位不是字节，而是数据块（block）。如果不加单位，则按指定数量的数据块大小来查找。这里的数据块指硬盘扇区，每个扇区512kB。
  * `-inum`：按inode来搜索文件。


  * ……

* 高阶选项：

  * 多条件搜索：
    * `-a`代表逻辑与。左右两边的条件都要满足。例：：`find /etc -size +20k -a -size -50k`。
    * `-o`带包逻辑或。左右两个条件满足一个即可。
  * 对搜索结果进行操作：`-exec 第二条命令 {} \;`，尾部的`{} \;`是固定搭配。{}代表查找到的文件名。
    * 显示查询结果：`find /etc -size +20k -exec ls -lh {}\;`。
    * 查找并删除：`find /etc -size +20k -exec rm -rf {}\;`


### 字符串搜索命令`grep`

* `grep [选项] 字符串 文件名`：在指定的文件中搜索符合匹配条件的字符串。（全面搜索正则表达式并把行打印出来。）
  * `-i`：忽略大小写。
  * `-v`：排除指定字符串。
* 若要进行模糊查询，应使用正则表达式。



### `find`命令与`grep`命令的区别

* find命令：在系统中搜索符合条件的文件名。**使用通配符，完全匹配**。
* grep命令：在文件中搜索符合条件的字符串。**使用正则表达式，包含匹配**。



### 搜索命令的命令`whereis`与`which`

- `whereis [选项] 命令名`：搜索命令所在路径及帮助文档所在位置。 （不可用于搜索文件）
  - `-b`：只查找可执行文件。
  - `-m`：只查找帮助文件。
- `which 命令名`： 搜索命令所在路径及别名。若有别名，则显示别名。没有就不显示。
  - 用于查找并显示给定命令的绝对路径，环境变量PATH中保存了查找命令时需要遍历的目录。which指令会在环境变量$PATH设置的目录里查找符合条件的文件。也就是说，使用which命令，就可以看到某个系统命令是否存在，以及执行的到底是哪一个位置的命令。
  - 命令的别名有`alias`命令设置。alias命令的作用只局限于该次登入的操作。若要每次登入都能够使用这些命令别名，则可将相应的alias命令存放到bash的初始化文件`/etc/bashrc`中。

PS：像`cd`这种类型的`shell`内置命令，没有可执行文件，无法找到。只能找到帮助文档。



### `$PATH`环境变量

如果我们想执行某个文件，必须指定其路径。要么使用绝对路径，要么使用其相对于当前工作路径的相对路径。比如调用`ls`，实际上需要输入`/bin/ls`来执行。但这种方式很麻烦。于是，Linux提供了`$PATH`环境变量，它是一个字符串，保存着多个目录，目录之间用`:`隔开。当我们输入一个命令时，系统先在当前目录下查找可执行文件。如果没找到，则到`$PATH`变量指定的各个目录，依次查找匹配的可执行文件。因此，当我们希望自己开发的命令能够被系统识别时，要么将可执行文件放入`$PATH`指定某个目录中，要么将可执行文件的路径添加到`$PATH`中。

centos 7中，`$PATH`默认的值为：

```
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin
```



## 四、帮助命令

### `man`

* `man`：格式化并显示在线帮助手册页。是最常用的帮助命令。是manual（手册）的缩写。
  * 在手册页面，输入`/-d`可以查找`-d`这个选项。再按`n`，是继续向下查找。再按`shift+n`，是向上查找。
* `man`的级别：一个命令的帮助手册可能是分为多个级别的（即有多个帮助手册，每个帮助手册针对不同的应用场景）。这些手册分为不同的级别。通过输入命令`man man`可以看到各个级别描述：
  1. 查看命令的帮助。
  2. 查看可被内核调用的函数的帮助。
  3. 查看函数和函数库的帮助。
  4. 查看特殊文件的帮助（主要是/dev目录下的文件）。
  5. 查看配置文件的帮助。
  6. 查看游戏的帮助。
  7. 查看其它杂项的帮助。
  8. 查看系统管理员可用命令的帮助（/sbin目录下的命令）。
  9. 查看和内核相关的文件的帮助。
* 如何查看一个命令拥有哪些级别的帮助手册：
  * `man -f 命令`或者`whatis 命令`。
  * `whereis 命令`：搜索命令所在路径及帮助文档所在位置。该命令可看出有几个帮助手册，同时还有命令相关的其他文件位置。
* 如何查看一个命令特定等级的帮助手册:
  * `man -5 password`：查看password等级为5的帮助手册。
* 查看和命令相关的所有帮助手册列表：
  * `man -k 命令`或者`apropos 命令`。这个命令会显示所有名称中包含所输入的命令关键字的帮助手册列表。

### 其他帮助命令

* 获取命令选项的帮助：`命令 --help`。
  * 例：`ls --help`。
* 获取shell内部命令帮助：`help shell内部命令`。
  * 内部命令的帮助手册无法通过`man`获取直接。比如，如果输入`man cd`，则显示的是bash的帮助手册，其中包含所有的内部命令帮助信息，但是很难找。
  * 如何判断一个命令是不是shell内部命令？教程中说用`whereis 命令`查看该命令是否有可执行路径。若没有就是shell内部命令。但实验发现该方法不靠谱，比如cd命令，可以查看到执行路径`/usr/bin/cd`。正确的做法是，使用`type 命令`。
* `info`命令：Linux将系统中所有命令的帮助文档组合成一个大型文档。利用info命令，可以定位到该大文档中的一个位置。
  * 回车：进入子帮助页面（带有*号标记）。
  * `-u`：进入上层页面。
  * `-n`：进入下一个帮助小节。
  * `-p`：进入上一个帮助小节。
  * `-q`：退出。



## 五、压缩与解压缩命令

### 常用压缩格式

* .zip
* .gz
* .bz2
* .tar（注意，.tar并不是压缩文件。它只是用于将多个文件打包为一个文件，方便其他压缩命令进行压缩。因为有些压缩命令是不能直接压缩目录的。）
* .tar.gz
* .tar.bz2

### zip(.zip)

* 压缩：`zip [-r] 压缩文件名 源文件（或目录）`。（注意这里压缩文件和源文件的先后顺序，与目录操作命令不一样）
  * 压缩文件：`zip longzls.zip longzls`。
  * 压缩目录：`zip -r jp japan`。注意，如果不加`-r`，也可压缩成功。但是只会压缩空目录，其内部文件不会一起压缩。`-r`应该是递归压缩的意思。
* 解压缩：`unzip 压缩文件`
  * 解压缩到指定目录：`unzip 压缩文件名 -d 目标目录`

### gzip(.gz)

* 压缩：
  * `gzip 源文件名`，压缩为.gz格式的压缩文件，源文件会消失。注意不用指定压缩后的文件名。
  * `gzip -c 源文件 > 压缩文件`：压缩为.gz格式的压缩文件，源文件保留。该命令的实质是，通过指定`-c`选项，将压缩结果输出到标准IO，然后通过重定向的方式输入到压缩文件。
  * `gzip -r 目录`：压缩目录下所有的子文件，注意**它不是压缩目录，而是压缩目录里的子文件**。如果压缩目录中有子目录，则子目录保持不变，但是其内部子文件会递归地被压缩。
* 解压缩：
  * `gzip -d 压缩文件名`，解压文件，压缩包会删除。
  * `gunzip 压缩包名`，解压文件，压缩包会删除。
  * `gunzip -r 目录名`，递归解压目录下所有压缩包。

### .bz2

* 压缩
  * `bzip2 源文件名`：压缩为.bz2格式，不保留源文件。
  * `bzip2 -k 源文件名`：压缩为.bz2格式，保留源文件。
  * 注意，**bzip2命令不能压缩目录**。
* 解压缩
  * `bzip2 -d 压缩文件名`：解压缩文件。加上`-k`保留源文件。
  * `bunzip2 压缩文件名`：解压缩文件。加上`-k`保留源文件。

### 打包命令tar（.tar）

* 打包：`tar -cvf 生成的打包文件名 源文件名`
  * `-c`：打包。
  * `-v`：显示过程。
  * `-f`：指定打包后的文件名。
  * 例：`tar -cvf longzls.tar longzls`
  * 打包完成后，就可以用其他压缩命令进行压缩。打包之后再压缩，之后解压，并不会产生多一层目录。
* 解包：`tar -xvf 打包文件名`
* .tar.gz：
  * 直接压缩为.tar.gz：`tar -zcvf 压缩包名.tar.gz 源文件名`：
    * `-z`：压缩为.tar.gz格式。
  * 直接解压.tar.gz：`tar -zxvf 压缩包名.tar.gz`。
    * 解压命令加`-C`参数，可以指定解压目录。`tar -zxvf 压缩包名.tar.gz -C 目标目录 `。
  * 只查看压缩包内文件，但不解压：`tar -ztvf 压缩包名.tar.gz` 
* .tar.bz2：
  * 直接压缩为.tar.bz2：`tar -jcvf 压缩包名.tar.gz 源文件名`。
  * 直接解压.tar.gz：`tar -jxvf 压缩包名.tar.gz`。



## 六、关机和重启命令

### `shutdown`命令

* `shutdown [选项] 时间`，重启或关闭。时间可以为`now`。
  * `-c`：取消前一个关机命令。
  * `-h`：关机。尽量不要远程关机，因为“怎么开”是个问题。
  * `-r`：重启。
* 当执行完该命令后，如果指定了一个未来的关机时间，默认情况下shell将保持在当前关机程序中，无法进行其他操作。可输入`&`，来将该关机程序放入后台，从而让前台可以继续执行其他操作。
  * `shutdown -r 23:30 &`。 
* `shutdown`命令较安全，关机和重启最好使用该命令。




PS，通过`date`命令，可以查看当前时间。

### 其他关机命令

* `halt`
* `poweroff`
* `init 0`

### 其他重启命令

* `reboot`：这个也比较安全。
* `init 6`

### 系统运行级别

* `init [级别]`：指定Linux系统要切换到的运行等级。

  0. 关机。
  1. 单用户。（类似于window的安全模式）
  2. 不完全多用户，不含NFS服务。
  3. 完全多用户。
  4. 未分配。
  5. 图像界面。
  6. 重启。


* `runlevel`：查看系统当前运行级别（前一个级别+当前级别）。
* 设置系统开机时的默认运行级别：
* init貌似已经过时：http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html

`logout`：当远程登录到主机时，必须正确退出登录，不然会一直占用远程登录端口号。这个数量有限。

## 七、其他常用命令

### 挂载命令

#### 1.查询与自动挂载

* `mount`：查询系统中已经挂载的设备。
* `mount -a`：依据配置文件/etc/fstab的内容，自动挂载。
  * /etc/fstab：记录Linux系统中开机自动挂载的配置信息。

#### 2.挂载命令格式

* `mount [-t 文件系统] [-o 特殊选项] 设备文件名 挂载点`
  * `[-t 文件系统]`：指定挂载的文件系统类型。如ext3、ext4、xfs、iso9660等。
  * `[-o 特殊选项]`：可以指定挂载的额外选项。
  * `设备文件名`：硬件设备对应的文件名。
  * `挂载点`：一个已经存在的空白目录。
  * 退出登录命令

* `[-o 特殊选项]`详解：

  * atime/noatime：更新访问时间/不更新访问时间。设置访问分区文件时，是否更新文件的访问时间。默认是更新。
  * async/sync：异步/同步。默认为异步。
  * auto/noauto：自动/手动。mount -a命令执行时，是否会自动安装/etc/fstab文件内容挂载，默认为自动。
  * defaults：定义默认值。
  * exec/noexec：允许执行/不允许执行。设定是否允许在文件系统中执行可执行文件。默认是exec允许。
  * remount：重新挂载已经挂载的文件系统，一般用于指定特殊权限。
  * rw/ro：读写/只读。指定文件系统挂载时，是否具有读写权限。默认是rw。
  * ......

  示例：`mount -o remount,noexec /home`：设置/home分区不可执行，然后重新挂载以生效。注意，由于/home分区已经挂载了，它和硬盘分区现在是关联的，所以这里重新挂载时只需要指定/home挂载点就行了，可以省略设备名。

#### 3.挂载光盘

（1）在光驱中放入光盘。

（2）建立挂载点。任何一个空目录都可以作为盘符。

* `mkdir /mnt/cdrom`

（3）执行挂载命令。

* `mount -t iso9660 /dev/sr0 /mnt/cdrom`。注意，`/dev/cdrom`是`/dev/sr0`的软链接，指定任意一个作为设备名都代表光驱。但推荐用sr0。另外，其实这里的`-t iso9660`是可以省略的，系统会自动使用iso9660作为光盘的文件系统。
  * `mount /dev/sr0 /mnt/cdrom`

（4）进入挂载点，访问光盘内容。

* `cd /mnt/cdrom`

#### 4.卸载命令

Linux中，如果不卸载已挂载的设备，强行拔除可能会造成数据丢失。如果是光盘，未卸载前，无法弹出。

* `umount 设备名或挂载点`。卸载时不能在挂载点目录中。

#### 5.挂载U盘

在Linux中，光盘的设备名是固定的`/dev/sr0`。但是U盘不一定，它按照硬盘的命名规则一次排序。插入时才知道设备名。

（1）插入U盘，然后通过`fdisk -l`命令查看U盘的设备名。

（2）创建挂载点。

（3）执行挂载命令：`mount -t vfat /dev/sdb1 /mnt/usb`



注意，Linux默认是不支持NTFS文件系统的，故一般移动硬盘不能直接挂载。

### 用户登录查看命令

#### 1.`w`

**w命令**用于显示已经登陆系统的用户列表，并显示用户执行的指令等信息。

命令输出：

* USER：用户的登录名。
* TTY：登录终端。
* FROM：从哪个IP地址登录。
* LOGIN@：登录时间。
* IDLE：用户闲置时间。
* JCPU：和该终端连接的所有进程占用的时间。这个时间不包括过去的后台作业时间，但包括当前正在运行的后台作业所占用时间。
* PCPU：当前进程所占用的时间。
* WHAT：当前正在运行的命令。

> 实验中，使用Xshell远程登录Linux（以root身份），执行w，看到有两个root用户（USER），其终端一个为tty1，一个为pts/0。其中tty1代表Linux本机登录，没有来源IP（FROM）；pts/0代表远程登录，可看到远程IP（FROM）。

`w 用户名`：查看特定用户。

#### 2.`who`

`who`命令用于显示已经登陆系统的用户列表。不能查看其它信息。

命令输出：

* 用户名
* 登录终端
* 登录时间、来源

####3.`last`

`last`查询当前登录和过去登录的用户信息记录。

`last`默认是读取/var/log/wtmp文件数据。该文件如果直接用vi打开，是乱码。

命令输出：

* 用户名
* 登录终端
* 登录IP
* 登录时间
* 退出时间（在线时间）

####4.`lastlog`

`lastlog`查看所有用户最后一次登录时间。

`lastlog`默认是读取/var/log/wtmp文件数据。

命令输出：

- 用户名
- 登录终端
- 登录IP
- 最后一次登录时间



